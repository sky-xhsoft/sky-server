# ç®¡ç†å‘˜é»˜è®¤æƒé™åŠŸèƒ½

**å®ç°æ—¥æœŸ**: 2026-01-12

## åŠŸèƒ½æ¦‚è¿°

ä¸ºæƒé™ç³»ç»Ÿæ·»åŠ ç®¡ç†å‘˜ç‰¹æ®Šæƒé™æœºåˆ¶ï¼šå½“ç”¨æˆ·çš„ `IS_ADMIN='Y'` æ—¶ï¼Œè‡ªåŠ¨æ‹¥æœ‰ç³»ç»Ÿæ‰€æœ‰æƒé™ï¼Œæ— éœ€é…ç½®æƒé™ç»„ã€‚

## ä¸šåŠ¡èƒŒæ™¯

åœ¨å…ƒæ•°æ®é©±åŠ¨çš„ç³»ç»Ÿä¸­ï¼Œæƒé™æ§åˆ¶é€šè¿‡ä»¥ä¸‹é“¾è·¯å®ç°ï¼š

```
ç”¨æˆ· â†’ æƒé™ç»„ â†’ å®‰å…¨ç›®å½• â†’ è¡¨å• â†’ å­—æ®µ
```

ä½†ç³»ç»Ÿç®¡ç†å‘˜é€šå¸¸éœ€è¦è®¿é—®æ‰€æœ‰åŠŸèƒ½ï¼Œå¦‚æœä¸ºç®¡ç†å‘˜é…ç½®å…¨éƒ¨æƒé™ç»„ä¼šéå¸¸ç¹çã€‚å› æ­¤å¼•å…¥ç®¡ç†å‘˜é»˜è®¤æƒé™æœºåˆ¶ã€‚

## å®ç°åŸç†

### 1. æƒé™æ£€æŸ¥æµç¨‹

**ä¿®æ”¹å‰**:
```
1. æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢æƒé™ç»„
2. æ ¹æ®æƒé™ç»„æŸ¥è¯¢ç›®å½•æƒé™
3. ä½è¿ç®—æ£€æŸ¥æ˜¯å¦æœ‰æ‰€éœ€æƒé™
4. è¿”å›æƒé™æ£€æŸ¥ç»“æœ
```

**ä¿®æ”¹å**:
```
1. â­ æ£€æŸ¥ç”¨æˆ· IS_ADMIN å­—æ®µ
2. â­ å¦‚æœ IS_ADMIN='Y'ï¼Œç›´æ¥è¿”å›æœ‰æƒé™
3. å¦åˆ™ç»§ç»­åŸæœ‰æƒé™æ£€æŸ¥æµç¨‹
4. è¿”å›æƒé™æ£€æŸ¥ç»“æœ
```

### 2. ä¿®æ”¹çš„æ ¸å¿ƒæ–¹æ³•

#### 2.1 èœå•æœåŠ¡ - GetUserMenuTree

**æ–‡ä»¶**: `internal/service/menu/menu_service.go`

**ä¿®æ”¹å†…å®¹**:
```go
func (s *service) GetUserMenuTree(ctx context.Context, userID, companyID uint) ([]*entity.MenuNode, error) {
    // 1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
    var isAdmin string
    if err := s.db.WithContext(ctx).
        Table("sys_user").
        Select("IS_ADMIN").
        Where("ID = ? AND IS_ACTIVE = ?", userID, "Y").
        Scan(&isAdmin).Error; err != nil {
        return nil, fmt.Errorf("æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥: %w", err)
    }

    // å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œç›´æ¥è¿”å›å®Œæ•´èœå•æ ‘
    if isAdmin == "Y" {
        return s.GetMenuTree(ctx, companyID)
    }

    // å¦åˆ™ç»§ç»­æƒé™è¿‡æ»¤...
}
```

**å½±å“èŒƒå›´**: èœå•æ˜¾ç¤º
**åŠŸèƒ½**: ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°ç³»ç»Ÿæ‰€æœ‰èœå•ï¼Œæ— éœ€é…ç½®æƒé™

#### 2.2 æƒé™ç»„æœåŠ¡ - CheckUserPermission

**æ–‡ä»¶**: `internal/service/groups/groups_service.go`

**ä¿®æ”¹å†…å®¹**:
```go
func (s *service) CheckUserPermission(ctx context.Context, userID uint, directoryID uint, permission int) (bool, error) {
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
    var isAdmin string
    if err := s.db.WithContext(ctx).
        Table("sys_user").
        Select("IS_ADMIN").
        Where("ID = ? AND IS_ACTIVE = ?", userID, "Y").
        Scan(&isAdmin).Error; err != nil {
        return false, errors.Wrap(errors.ErrDatabase, "æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥", err)
    }

    // å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œç›´æ¥è¿”å›æœ‰æƒé™
    if isAdmin == "Y" {
        return true, nil
    }

    // å¦åˆ™ç»§ç»­æƒé™æ£€æŸ¥...
}
```

**å½±å“èŒƒå›´**: æ‰€æœ‰åŸºäºç›®å½•çš„æƒé™æ£€æŸ¥
**åŠŸèƒ½**: ç®¡ç†å‘˜å¯¹æ‰€æœ‰ç›®å½•éƒ½æœ‰æƒé™

#### 2.3 æƒé™ç»„æœåŠ¡ - GetUserDirectoryPermission

**ä¿®æ”¹å†…å®¹**:
```go
func (s *service) GetUserDirectoryPermission(ctx context.Context, userID uint, directoryID uint) (int, error) {
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
    var isAdmin string
    if err := s.db.WithContext(ctx).
        Table("sys_user").
        Select("IS_ADMIN").
        Where("ID = ? AND IS_ACTIVE = ?", userID, "Y").
        Scan(&isAdmin).Error; err != nil {
        return 0, errors.Wrap(errors.ErrDatabase, "æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥", err)
    }

    // å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œè¿”å›å…¨éƒ¨æƒé™
    if isAdmin == "Y" {
        return PermAll, nil  // PermAll = 63 (æ‰€æœ‰æƒé™ä½)
    }

    // å¦åˆ™æŸ¥è¯¢å®é™…æƒé™...
}
```

**å½±å“èŒƒå›´**: è·å–ç”¨æˆ·æƒé™å€¼
**åŠŸèƒ½**: ç®¡ç†å‘˜åœ¨ä»»ä½•ç›®å½•éƒ½æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼ˆè¯»ã€åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ã€å¯¼å‡ºã€å¯¼å…¥ï¼‰

#### 2.4 æƒé™ç»„æœåŠ¡ - CheckUserTablePermission

**ä¿®æ”¹å†…å®¹**:
```go
func (s *service) CheckUserTablePermission(ctx context.Context, userID uint, tableID uint, permission int) (bool, error) {
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
    var isAdmin string
    if err := s.db.WithContext(ctx).
        Table("sys_user").
        Select("IS_ADMIN").
        Where("ID = ? AND IS_ACTIVE = ?", userID, "Y").
        Scan(&isAdmin).Error; err != nil {
        return false, errors.Wrap(errors.ErrDatabase, "æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥", err)
    }

    // å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œç›´æ¥è¿”å›æœ‰æƒé™
    if isAdmin == "Y" {
        return true, nil
    }

    // å¦åˆ™ç»§ç»­æƒé™æ£€æŸ¥...
}
```

**å½±å“èŒƒå›´**: CRUD æ“ä½œæƒé™æ£€æŸ¥
**åŠŸèƒ½**: ç®¡ç†å‘˜å¯¹æ‰€æœ‰è¡¨éƒ½æœ‰æ“ä½œæƒé™

## æƒé™ä½å®šä¹‰

ç³»ç»Ÿä½¿ç”¨ä½è¿ç®—è¡¨ç¤ºæƒé™ï¼š

```go
const (
    PermNone   = 0      // 0      - æ— æƒé™
    PermRead   = 1 << 0 // 1      - è¯»å–
    PermCreate = 1 << 1 // 2      - åˆ›å»º
    PermUpdate = 1 << 2 // 4      - æ›´æ–°
    PermDelete = 1 << 3 // 8      - åˆ é™¤
    PermExport = 1 << 4 // 16     - å¯¼å‡º
    PermImport = 1 << 5 // 32     - å¯¼å…¥
    PermAll    = 63     // 111111 - æ‰€æœ‰æƒé™
)
```

ç®¡ç†å‘˜çš„æƒé™å€¼ä¸º `PermAll = 63`ï¼Œå³äºŒè¿›åˆ¶ `111111`ï¼Œæ‹¥æœ‰å…¨éƒ¨6ç§æƒé™ã€‚

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: ç³»ç»Ÿåˆå§‹åŒ–

**éœ€æ±‚**: é¦–æ¬¡éƒ¨ç½²ç³»ç»Ÿï¼Œç®¡ç†å‘˜éœ€è¦é…ç½®å…ƒæ•°æ®ã€æƒé™ç»„ç­‰åŸºç¡€æ•°æ®

**å®ç°**:
```sql
-- init.sql ä¸­åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
INSERT INTO sys_user (
    ID, USERNAME, PASSWORD, TRUE_NAME, IS_ADMIN, IS_ACTIVE
) VALUES (
    1, 'admin', '$2a$10$...', 'ç³»ç»Ÿç®¡ç†å‘˜', 'Y', 'Y'
);
```

**ä¼˜åŠ¿**:
- âœ… ç®¡ç†å‘˜æ— éœ€é…ç½®æƒé™ç»„å³å¯è®¿é—®æ‰€æœ‰åŠŸèƒ½
- âœ… ç®€åŒ–ç³»ç»Ÿåˆå§‹åŒ–æµç¨‹
- âœ… é¿å…"é¸¡ç”Ÿè›‹"é—®é¢˜ï¼ˆéœ€è¦æƒé™æ‰èƒ½é…ç½®æƒé™ï¼‰

### åœºæ™¯ 2: æ—¥å¸¸è¿ç»´

**éœ€æ±‚**: ç®¡ç†å‘˜éœ€è¦å¤„ç†å„ç±»é—®é¢˜ï¼Œè®¿é—®å„ç§è¡¨å•

**è¡Œä¸º**:
- ç®¡ç†å‘˜ç™»å½•åå¯ä»¥çœ‹åˆ°æ‰€æœ‰èœå•
- å¯¹ä»»ä½•è¡¨å•éƒ½æœ‰å¢åˆ æ”¹æŸ¥æƒé™
- æ— éœ€ä¸ºç®¡ç†å‘˜åˆ†é…æƒé™ç»„

**ä¼˜åŠ¿**:
- âœ… ç®€åŒ–ç®¡ç†å‘˜æƒé™ç®¡ç†
- âœ… é¿å…ç®¡ç†å‘˜å› æƒé™ä¸è¶³æ— æ³•å¤„ç†é—®é¢˜
- âœ… æé«˜è¿ç»´æ•ˆç‡

### åœºæ™¯ 3: å¤šç®¡ç†å‘˜åä½œ

**éœ€æ±‚**: å¯èƒ½å­˜åœ¨å¤šä¸ªç®¡ç†å‘˜è´¦æˆ·

**å®ç°**:
```sql
-- è®¾ç½®ç”¨æˆ·ä¸ºç®¡ç†å‘˜
UPDATE sys_user
SET IS_ADMIN = 'Y'
WHERE ID = 2;

-- å–æ¶ˆç®¡ç†å‘˜æƒé™
UPDATE sys_user
SET IS_ADMIN = 'N'
WHERE ID = 2;
```

**ä¼˜åŠ¿**:
- âœ… çµæ´»æ§åˆ¶ç®¡ç†å‘˜èº«ä»½
- âœ… æ— éœ€é…ç½®å¤æ‚çš„æƒé™ç»„
- âœ… ä¸€ä¸ªå­—æ®µå³å¯æ§åˆ¶å…¨éƒ¨æƒé™

## å®‰å…¨è€ƒè™‘

### 1. ç®¡ç†å‘˜è´¦æˆ·ä¿æŠ¤ âš ï¸

**é£é™©**: ç®¡ç†å‘˜æ‹¥æœ‰ç³»ç»Ÿå…¨éƒ¨æƒé™ï¼Œè´¦æˆ·æ³„éœ²åæœä¸¥é‡

**é˜²æŠ¤æªæ–½**:
1. ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥ï¼ˆbcrypt åŠ å¯†ï¼‰
2. é™åˆ¶ç®¡ç†å‘˜è´¦æˆ·æ•°é‡
3. å®¡è®¡æ—¥å¿—è®°å½•æ‰€æœ‰ç®¡ç†å‘˜æ“ä½œ
4. å®šæœŸå®¡æŸ¥ç®¡ç†å‘˜åˆ—è¡¨

### 2. æƒé™æœ€å°åŒ–åŸåˆ™ âœ…

**åŸåˆ™**: éå¿…è¦ä¸æˆäºˆç®¡ç†å‘˜æƒé™

**å»ºè®®**:
```sql
-- ä¸æ¨èï¼šæ‰€æœ‰å‘˜å·¥éƒ½æ˜¯ç®¡ç†å‘˜
UPDATE sys_user SET IS_ADMIN = 'Y';  -- âŒ

-- æ¨èï¼šåªæœ‰å¿…è¦çš„äººå‘˜æ˜¯ç®¡ç†å‘˜
UPDATE sys_user
SET IS_ADMIN = 'Y'
WHERE USERNAME IN ('admin', 'superadmin');  -- âœ…
```

### 3. å®¡è®¡è¿½è¸ª âœ…

ç®¡ç†å‘˜çš„æ‰€æœ‰æ“ä½œéƒ½åº”è¯¥è®°å½•åˆ°å®¡è®¡æ—¥å¿—ï¼š

```sql
-- audit_log è¡¨è®°å½•ç®¡ç†å‘˜æ“ä½œ
SELECT
    USER_ID,
    USERNAME,
    ACTION,
    RESOURCE,
    CREATED_AT
FROM audit_log
WHERE USER_ID IN (
    SELECT ID FROM sys_user WHERE IS_ADMIN = 'Y'
)
ORDER BY CREATED_AT DESC;
```

### 4. åŒå› ç´ è®¤è¯ï¼ˆå»ºè®®ï¼‰â­

å¯¹äºç®¡ç†å‘˜è´¦æˆ·ï¼Œå»ºè®®å¯ç”¨åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰å¢å¼ºå®‰å…¨æ€§ã€‚

## æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹ 1: ç®¡ç†å‘˜èœå•è®¿é—®

**æ­¥éª¤**:
1. ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ï¼ˆIS_ADMIN='Y'ï¼‰
2. è°ƒç”¨ GET /api/v1/menus/user/tree
3. éªŒè¯è¿”å›æ‰€æœ‰èœå•ï¼ˆä¸å—æƒé™ç»„é™åˆ¶ï¼‰

**é¢„æœŸç»“æœ**: âœ… è¿”å›å®Œæ•´èœå•æ ‘

### æµ‹è¯•ç”¨ä¾‹ 2: ç®¡ç†å‘˜CRUDæ“ä½œ

**æ­¥éª¤**:
1. ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•
2. å¯¹ä»»æ„è¡¨æ‰§è¡Œ CRUD æ“ä½œï¼ˆCreate, Read, Update, Deleteï¼‰
3. éªŒè¯æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸ

**é¢„æœŸç»“æœ**: âœ… æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸæ‰§è¡Œ

### æµ‹è¯•ç”¨ä¾‹ 3: æ™®é€šç”¨æˆ·æƒé™é™åˆ¶

**æ­¥éª¤**:
1. ä½¿ç”¨æ™®é€šç”¨æˆ·ç™»å½•ï¼ˆIS_ADMIN='N'ï¼‰
2. å°è¯•è®¿é—®æœªæˆæƒçš„è¡¨å•
3. éªŒè¯è¿”å›æƒé™ä¸è¶³é”™è¯¯

**é¢„æœŸç»“æœ**: âŒ è¿”å› 403 Forbidden

### æµ‹è¯•ç”¨ä¾‹ 4: ç®¡ç†å‘˜æƒé™åˆ‡æ¢

**æ­¥éª¤**:
1. å°†ç”¨æˆ·çš„ IS_ADMIN ä» 'Y' æ”¹ä¸º 'N'
2. è¯¥ç”¨æˆ·é‡æ–°ç™»å½•
3. éªŒè¯åªèƒ½çœ‹åˆ°å·²æˆæƒçš„èœå•

**é¢„æœŸç»“æœ**: âœ… æƒé™ç«‹å³ç”Ÿæ•ˆï¼Œåªæ˜¾ç¤ºæˆæƒèœå•

## æ€§èƒ½ä¼˜åŒ–

### 1. ç®¡ç†å‘˜æ£€æŸ¥ä½ç½®

ç®¡ç†å‘˜æ£€æŸ¥æ”¾åœ¨æƒé™æ£€æŸ¥çš„**æœ€å‰é¢**ï¼ŒåŸå› ï¼š
- âœ… å‡å°‘æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°
- âœ… ç®¡ç†å‘˜æ“ä½œå“åº”æ›´å¿«
- âœ… é¿å…ä¸å¿…è¦çš„æƒé™ç»„è”è¡¨æŸ¥è¯¢

### 2. æŸ¥è¯¢ä¼˜åŒ–

```go
// åªæŸ¥è¯¢ IS_ADMIN å­—æ®µï¼Œä¸åŠ è½½æ•´ä¸ªç”¨æˆ·å¯¹è±¡
s.db.WithContext(ctx).
    Table("sys_user").
    Select("IS_ADMIN").           // åªé€‰æ‹©éœ€è¦çš„å­—æ®µ
    Where("ID = ? AND IS_ACTIVE = ?", userID, "Y").
    Scan(&isAdmin).Error
```

### 3. ç¼“å­˜å»ºè®®ï¼ˆæœªå®ç°ï¼‰â­

å¯ä»¥è€ƒè™‘ç¼“å­˜ç”¨æˆ·çš„ IS_ADMIN çŠ¶æ€ï¼š
```go
// ä¼ªä»£ç 
isAdmin := cache.Get(fmt.Sprintf("user:%d:is_admin", userID))
if isAdmin == nil {
    // æŸ¥è¯¢æ•°æ®åº“
    // ç¼“å­˜ç»“æœï¼ŒTTL = 5åˆ†é’Ÿ
}
```

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•å°†æ™®é€šç”¨æˆ·æå‡ä¸ºç®¡ç†å‘˜ï¼Ÿ

**A**: æ›´æ–° sys_user è¡¨çš„ IS_ADMIN å­—æ®µ
```sql
UPDATE sys_user
SET IS_ADMIN = 'Y',
    UPDATE_BY = 'admin',
    UPDATE_TIME = NOW()
WHERE ID = ç”¨æˆ·ID;
```

### Q2: ç®¡ç†å‘˜æ˜¯å¦è¿˜éœ€è¦é…ç½®æƒé™ç»„ï¼Ÿ

**A**: ä¸éœ€è¦ã€‚ç®¡ç†å‘˜è‡ªåŠ¨æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œæ— éœ€é…ç½®æƒé™ç»„ã€‚ä½†å¦‚æœé…ç½®äº†æƒé™ç»„ä¹Ÿä¸ä¼šå½±å“ç®¡ç†å‘˜æƒé™ã€‚

### Q3: å¦‚ä½•æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ç®¡ç†å‘˜ï¼Ÿ

**A**: æŸ¥è¯¢ sys_user è¡¨
```sql
SELECT ID, USERNAME, TRUE_NAME, EMAIL, CREATE_TIME
FROM sys_user
WHERE IS_ADMIN = 'Y'
  AND IS_ACTIVE = 'Y'
ORDER BY ID;
```

### Q4: ç®¡ç†å‘˜çš„æƒé™å€¼æ˜¯å¤šå°‘ï¼Ÿ

**A**: `PermAll = 63`ï¼Œå³äºŒè¿›åˆ¶ `111111`ï¼ŒåŒ…å«æ‰€æœ‰6ç§æƒé™ï¼ˆè¯»ã€åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ã€å¯¼å‡ºã€å¯¼å…¥ï¼‰

### Q5: å¦‚æœç®¡ç†å‘˜è´¦æˆ·è¢«ç¦ç”¨ä¼šæ€æ ·ï¼Ÿ

**A**: å¦‚æœ `IS_ACTIVE = 'N'`ï¼Œç”¨æˆ·æ— æ³•ç™»å½•ï¼Œç®¡ç†å‘˜æƒé™ä¹Ÿä¸ç”Ÿæ•ˆã€‚ç³»ç»Ÿåœ¨æƒé™æ£€æŸ¥æ—¶ä¼šåŒæ—¶åˆ¤æ–­ `IS_ADMIN = 'Y' AND IS_ACTIVE = 'Y'`

### Q6: è¿™ä¸ªæ”¹åŠ¨ä¼šå½±å“ç°æœ‰çš„æ™®é€šç”¨æˆ·å—ï¼Ÿ

**A**: ä¸ä¼šã€‚åªæœ‰ `IS_ADMIN = 'Y'` çš„ç”¨æˆ·ä¼šèµ°ç®¡ç†å‘˜é€»è¾‘ï¼Œæ™®é€šç”¨æˆ·ï¼ˆ`IS_ADMIN = 'N'` æˆ– NULLï¼‰ä»ç„¶ä½¿ç”¨æƒé™ç»„è¿›è¡Œæƒé™æ§åˆ¶ã€‚

## æ•°æ®åº“å­—æ®µ

### sys_user è¡¨

```sql
CREATE TABLE `sys_user` (
  `ID` int UNSIGNED NOT NULL AUTO_INCREMENT,
  `USERNAME` varchar(255) COMMENT 'ç”¨æˆ·åç§°',
  `PASSWORD` varchar(255) COMMENT 'å¯†ç ',
  `TRUE_NAME` varchar(255) COMMENT 'çœŸå®åç§°',
  `IS_ADMIN` char(2) DEFAULT 'N' COMMENT 'æ˜¯å¦ç®¡ç†å‘˜ (Y:æ˜¯, N:å¦)',  -- â­ å…³é”®å­—æ®µ
  `IS_ACTIVE` char(1) NOT NULL DEFAULT 'Y',
  `SYS_COMPANY_ID` int UNSIGNED NULL,
  `CREATE_BY` varchar(80) NULL,
  `CREATE_TIME` datetime NULL,
  `UPDATE_BY` varchar(80) NULL,
  `UPDATE_TIME` datetime NULL,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB COMMENT='ç³»ç»Ÿç”¨æˆ·';
```

**å…³é”®å­—æ®µè¯´æ˜**:
- `IS_ADMIN`: 'Y' è¡¨ç¤ºç®¡ç†å‘˜ï¼Œ'N' è¡¨ç¤ºæ™®é€šç”¨æˆ·
- é»˜è®¤å€¼ä¸º 'N'ï¼Œç¡®ä¿æ–°ç”¨æˆ·ä¸ä¼šæ„å¤–è·å¾—ç®¡ç†å‘˜æƒé™

## åç»­ä¼˜åŒ–å»ºè®®

### 1. ç¼“å­˜ä¼˜åŒ– â­

å½“å‰æ¯æ¬¡æƒé™æ£€æŸ¥éƒ½è¦æŸ¥è¯¢æ•°æ®åº“ï¼Œå¯ä»¥è€ƒè™‘ï¼š
- Redis ç¼“å­˜ç”¨æˆ·çš„ IS_ADMIN çŠ¶æ€
- ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼š5-10åˆ†é’Ÿ
- æ›´æ–°ç”¨æˆ·æ—¶æ¸…é™¤ç¼“å­˜

### 2. å®¡è®¡å¢å¼º â­

å¼ºåŒ–ç®¡ç†å‘˜æ“ä½œå®¡è®¡ï¼š
- è®°å½•æ‰€æœ‰ç®¡ç†å‘˜çš„æ“ä½œ
- ç‰¹æ®Šæ“ä½œï¼ˆåˆ é™¤ã€å¯¼å‡ºæ•æ„Ÿæ•°æ®ï¼‰å•ç‹¬æ ‡è®°
- å®šæœŸç”Ÿæˆç®¡ç†å‘˜æ“ä½œæŠ¥å‘Š

### 3. åˆ†çº§ç®¡ç†å‘˜ â­

è€ƒè™‘å¼•å…¥å¤šçº§ç®¡ç†å‘˜ï¼š
- è¶…çº§ç®¡ç†å‘˜ï¼ˆIS_ADMIN='Y'ï¼‰- å…¨éƒ¨æƒé™
- éƒ¨é—¨ç®¡ç†å‘˜ï¼ˆIS_ADMIN='P'ï¼‰- éƒ¨åˆ†æƒé™
- æ™®é€šç”¨æˆ·ï¼ˆIS_ADMIN='N'ï¼‰- æƒé™ç»„æ§åˆ¶

### 4. æƒé™æ—¥å¿— â­

åœ¨æƒé™æ£€æŸ¥æ—¶è®°å½•æ—¥å¿—ï¼š
```go
if isAdmin == "Y" {
    logger.Debug("Admin access granted",
        zap.Uint("userID", userID),
        zap.String("resource", "table/"+tableName))
    return true, nil
}
```

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´è¯´æ˜ |
|-----|------|---------|
| v1.0.0 | 2026-01-12 | åˆå§‹å®ç°ï¼Œæ·»åŠ ç®¡ç†å‘˜é»˜è®¤æƒé™æœºåˆ¶ |

## ç›¸å…³æ–‡æ¡£

- [æƒé™ç³»ç»Ÿè®¾è®¡æ–‡æ¡£](./permission-system.md)
- [èœå•ç³»ç»Ÿæ–‡æ¡£](./menu-system.md)
- [ç”¨æˆ·ç®¡ç†æ–‡æ¡£](./user-management.md)

## æ€»ç»“

ç®¡ç†å‘˜é»˜è®¤æƒé™åŠŸèƒ½çš„å¼•å…¥å¸¦æ¥ä»¥ä¸‹ä¼˜åŠ¿ï¼š

âœ… **ç®€åŒ–ç®¡ç†**: ç®¡ç†å‘˜æ— éœ€é…ç½®æƒé™ç»„
âœ… **æé«˜æ•ˆç‡**: ç®¡ç†å‘˜å¯ä»¥ç«‹å³è®¿é—®æ‰€æœ‰åŠŸèƒ½
âœ… **å‡å°‘é”™è¯¯**: é¿å…ç®¡ç†å‘˜å› æƒé™é…ç½®é”™è¯¯å¯¼è‡´çš„é—®é¢˜
âœ… **çµæ´»æ§åˆ¶**: é€šè¿‡ä¸€ä¸ªå­—æ®µå³å¯æ§åˆ¶ç®¡ç†å‘˜èº«ä»½
âœ… **å‘åå…¼å®¹**: ä¸å½±å“ç°æœ‰æ™®é€šç”¨æˆ·çš„æƒé™ä½“ç³»

è¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«é€‚åˆï¼š
- ğŸš€ ç³»ç»Ÿåˆå§‹åŒ–å’Œéƒ¨ç½²
- ğŸ‘¨â€ğŸ’¼ è¿ç»´å’Œæ•…éšœå¤„ç†
- ğŸ”§ ç³»ç»Ÿé…ç½®å’Œè°ƒè¯•
- ğŸ“Š æ•°æ®åˆ†æå’Œå®¡è®¡
